<table class="report-table" *ngFor="let point of points" style="page-break-after: always; page-break-before: always;">
    <tbody>
        <tr style="page-break-inside: avoid;">
            <div gdRows gdColumns="auto auto auto" gdAlignRows="start start" style="margin-bottom: 1rem;">
                <div gdColumns gdAuto="column" gdGap="1rem">
                    <div class="label">Vehicle No</div>
                    <div class="label-header">{{vehicleNo}}</div>
                </div>
            </div>
        </tr>
        <tr style="page-break-inside: avoid;">
            <td>
                <div gdColumns gdAlignRows="space-between" gdAuto="column" style="margin-bottom: 1rem;">
                    <div gdRows>
                        <div class="primary-txt">{{ point.pointno }}</div>
                        <div class="primary-txt">{{ point.vehicle_no }}</div>
                        <div class="primary-txt">{{ point.bore_type }}</div>
                    </div>
                    <div gdAlignColumns="start start" gdRows gdGap="0.5rem" class="panel">
                        <div class="panel-header">Agent Information</div>
                        <div gdColumns="5rem 2rem auto" gdGap="5px" gdAlignRows="start start">
                            <div class="label">Name</div>
                            <div>:</div>
                            <div>{{ point.agent_name }}</div>
                            <div class="label">State</div>
                            <div>:</div>
                            <div>{{ point.agent_state }}</div>
                            <div class="label">Mobile</div>
                            <div>:</div>
                            <div>{{ point.agent_mobile_no }}</div>
                        </div>
                    </div>
                    <div gdRows gdGap="0.5rem" class="panel">
                        <div class="panel-header">Party Information</div>
                        <div gdColumns="5rem 2rem auto" gdGap="5px" gdAlignRows="start start">
                            <div class="label">Name</div>
                            <div>:</div>
                            <div>{{ point.party_name }}</div>
                            <div class="label">City</div>
                            <div>:</div>
                            <div>{{ point.party_city }}</div>
                            <div class="label">State</div>
                            <div>:</div>
                            <div>{{ point.party_state }}</div>
                            <div class="label">Mobile</div>
                            <div>:</div>
                            <div>{{ point.party_mobile }}</div>
                            <div class="label">Date</div>
                            <div>:</div>
                            <div>{{ point.date }}</div>
                        </div>
                    </div>
                </div>
            </td>
        </tr>
        <tr style="page-break-inside: avoid;">
            <td>
                <div gdRows gdGap="0.5rem" class="panel">
                    <div class="panel-header">Point Report</div>
                    <div gdRows>
                        <div class="feet-header" gdColumns="17.5% 1% 17.5% 17.5% 1% 17.5% 1% auto" gdAuto="column">
                            <div class="text-center">Start Ft.</div>
                            <div>-</div>
                            <div class="text-center">End Ft.</div>
                            <div class="text-center">Total Ft.</div>
                            <div>x</div>
                            <div class="text-center">Amt. Per Ft.</div>
                            <div>=</div>
                            <div class="text-right">Amt.</div>
                        </div>
                        <div class="line m-t-5 m-b-5"></div>
                        <div gdRows>
                            <ng-container *ngFor="let feet of point.feets; let last = last">
                                <div gdColumns="17.5% 1% 17.5% 17.5% 1% 17.5% 1% auto" gdAuto="column">
                                    <div class="text-center">{{ feet.startFeet }}</div>
                                    <div>-</div>
                                    <div class="text-center">{{ feet.endFeet }}</div>
                                    <div class="text-center">{{ feet.feetDiff }}</div>
                                    <div>x</div>
                                    <div class="text-center">{{ feet.amtPerFeet }}</div>
                                    <div>=</div>
                                    <div class="text-right">{{ feet.totalAmt }}</div>
                                </div>
                                <div *ngIf="!last" class="dashed-line m-t-5 m-b-5"></div>
                                <div *ngIf="last" class="m-t-10" gdColumns gdAlignRows="start start" gdGap="1rem"
                                    gdAuto="column">
                                    <div class="footer-title">Total Feet</div>
                                    <div class="footer-title">-</div>
                                    <div class="font-italic line-space-1 amt-text">
                                        {{ point.total_feet }}</div>
                                </div>
                            </ng-container>
                            <div class="m-t-n-16" gdAlignColumns="center center" gdColumns="1fr minmax(50px, auto)"
                                gdGap="25px">
                                <div gdGridAlign="end end" class="bold font-14 text-right total-amt">
                                    Total
                                    Feet
                                    Amount</div>
                                <div fxLayout="column" style="margin-top: -25px;">
                                    <div class="total-line m-t-10 m-b-10" fxFlex="30"></div>
                                    <div fxFlex="30" class="text-right total-amt amt-text">{{
                            point.total_feet_amt | currency: 'INR' }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </td>
        </tr>
        <tr style="page-break-inside: avoid;" *ngIf="point?.casingDetails?.length">
            <td>
                <div gdRows gdGap="0.5rem" class="panel">
                    <div class="panel-header">Casing Details</div>
                    <div gdRows>
                        <div gdColumns="40% 15% 7.5% 15% 7.5% auto" gdGap="0.5rem" class="feet-header">
                            <div class="bold">Pipe Type</div>
                            <div class="bold">Casing Depth</div>
                            <div class="bold">x</div>
                            <div class="bold">Casing Depth Rate</div>
                            <div class="bold">=</div>
                            <div class="bold text-right">Amount</div>
                        </div>
                        <div class="line m-b-5 m-t-5"></div>
                        <ng-container *ngFor="let casing of point.casingDetails; let last = last">
                            <div gdColumns="40% 15% 7.5% 15% 7.5% auto" gdGap="0.5rem">
                                <div>{{ casing.name }}</div>
                                <div class="text-center">{{ casing.depth }}</div>
                                <div>x</div>
                                <div class="text-center">{{ casing.depthRate }}</div>
                                <div>=</div>
                                <div class="text-right">{{ casing.totalAmount }}</div>
                            </div>
                            <div *ngIf="!last" class="m-t-5 m-b-5 dashed-line"></div>
                        </ng-container>
                        <div gdAlignColumns="center center" gdColumns="1fr minmax(50px, auto)" gdGap="25px">
                            <div gdGridAlign="end end" class="bold font-14 text-right total-amt">Total
                                Casing Amount</div>
                            <div fxLayout="column">
                                <div class="total-line m-t-10 m-b-10" fxFlex="30"></div>
                                <div fxFlex="30" class="text-right total-amt amt-text">
                                    {{ (point.total_casing_amt || 0) | currency: 'INR' }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
        </tr>
        <tr style="page-break-inside: avoid;" *ngIf="point?.no_of_welding">
            <div gdRows gdGap="0.5rem" class="panel">
                <div class="panel-header">Welding Charges</div>
                <div gdColumns="70% 15% auto">
                    <div gdRows>
                        <div gdColumns="30% 10% 60%" gdGap="1rem" class="feet-header text-center">
                            <div>Welding</div>
                            <div>x</div>
                            <div>Amount Per Welding</div>
                        </div>
                        <div class="text-center" gdColumns="30% 10% 60%" gdGap="1rem">
                            <div>{{ point.no_of_welding || 0 }}</div>
                            <div>x</div>
                            <div>{{ point.amount_per_welding || 0 }}</div>
                        </div>
                    </div>
                    <div gdRows gdAlignColumns="end end">=</div>
                    <div gdRows gdAlignRows="end end" gdAlignColumns="end end">
                        {{ (point.total_welding_amount || 0) | currency: 'INR' }}</div>
                </div>

            </div>
        </tr>
        <tr style="page-break-inside: avoid;">
            <div gdRows gdGap="0.5rem" class="panel">
                <div class="panel-header">Other Charges</div>
                <div gdRows>
                    <div gdColumns="70% 20% auto">
                        <div class="text-right">Beta / Travel allowance</div>
                        <div class="text-center">-</div>
                        <div class="text-right">{{ point.allowance || 0 }}</div>
                    </div>
                    <div gdColumns="1fr  minmax(50px, auto)" gdGap="2rem">
                        <div gdRows gdAlignColumns="end end" class="text-right bold font-14">Total Other Charges</div>
                        <div gdRows>
                            <div class="total-line m-t-10 m-b-10"></div>
                            <div class="text-right">{{ (point.allowance || 0) | currency: 'INR'  }}</div>
                        </div>
                    </div>
                </div>
            </div>

        </tr>
        <tr style="page-break-inside: avoid;">
            <div gdRows gdGap="5px">
                <div gdGap="2rem" gdColumns="1fr minmax(50px, auto)">
                    <div class="text-right bold font-14">Overall Amount</div>
                    <div>{{ (point.overallAmt || 0) | currency: 'INR' }}</div>
                </div>
                <div gdGap="2rem" gdColumns="1fr minmax(50px, auto)">
                    <div class="text-right bold font-14">Advance Amount</div>
                    <div>- {{ (point.advance.advance || 0) | currency: 'INR' }}</div>
                </div>
                <div gdGap="2rem" gdColumns="1fr minmax(50px, auto)" gdAlignColumns="end end">
                    <div class="text-right bold font-14">Balance Amount</div>
                    <div gdRows gdGap="5px">
                        <div class="total-line"></div>
                        <div>
                            {{ ((point.overallAmt || 0) - (point.advance.advance || 0)) | currency: 'INR' }}
                        </div>
                    </div>
                </div>
            </div>

        </tr>
        <tr style="page-break-inside: avoid;">
            <div class="font-italic">Remarks</div>
            <div class="dashed-line"></div>
            <div>{{ point?.advance?.remarks }}</div>
        </tr>
    </tbody>
</table>